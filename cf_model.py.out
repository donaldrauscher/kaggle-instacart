17/07/30 13:45:04 INFO org.spark_project.jetty.util.log: Logging initialized @2691ms
17/07/30 13:45:04 INFO org.spark_project.jetty.server.Server: jetty-9.2.z-SNAPSHOT
17/07/30 13:45:04 INFO org.spark_project.jetty.server.ServerConnector: Started ServerConnector@1c18c62d{HTTP/1.1}{0.0.0.0:4040}
17/07/30 13:45:04 INFO org.spark_project.jetty.server.Server: Started @2836ms
17/07/30 13:45:04 INFO com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystemBase: GHFS version: 1.6.1-hadoop2
17/07/30 13:45:05 INFO org.apache.hadoop.yarn.client.RMProxy: Connecting to ResourceManager at cluster-1-m/10.128.0.3:8032
17/07/30 13:45:07 INFO org.apache.hadoop.yarn.client.api.impl.YarnClientImpl: Submitted application application_1501422265636_0001
17/07/30 13:45:14 WARN org.apache.spark.SparkContext: Spark is not running in local mode, therefore the checkpoint directory must not be on the local filesystem. Directory 'checkpoint/' appears to be on the local filesystem.
17/07/30 13:45:15 INFO org.apache.hadoop.mapred.FileInputFormat: Total input paths to process : 1
Training model...
[Stage 2:>                                                         (0 + 8) / 30][Stage 2:=>                                                        (1 + 8) / 30][Stage 2:=====>                                                    (3 + 8) / 30][Stage 2:=======>                                                  (4 + 8) / 30][Stage 2:===========>                                              (6 + 8) / 30][Stage 2:=============>                                            (7 + 8) / 30][Stage 2:===================>                                     (10 + 8) / 30][Stage 2:========================>                                (13 + 8) / 30][Stage 2:============================>                            (15 + 8) / 30][Stage 2:==============================>                          (16 + 8) / 30][Stage 2:======================================>                  (20 + 8) / 30][Stage 2:===========================================>             (23 + 7) / 30][Stage 2:=================================================>       (26 + 4) / 30][Stage 2:=====================================================>   (28 + 2) / 30][Stage 3:===>                                                      (2 + 6) / 30][Stage 3:===================>                                     (10 + 6) / 30][Stage 3:====================================>                    (19 + 6) / 30][Stage 3:===================================================>     (27 + 3) / 30][Stage 4:==================================>                       (9 + 6) / 15][Stage 4:=================================================>       (13 + 2) / 15]                                                                                17/07/30 13:45:29 INFO com.github.fommil.jni.JniLoader: successfully loaded /tmp/jniloader1946473403331364150netlib-native_system-linux-x86_64.so
[Stage 16:======================>                                  (6 + 6) / 15][Stage 16:=========================================>              (11 + 3) / 15][Stage 16:====================================================>   (14 + 1) / 15]                                                                                [Stage 23:============================================>           (12 + 2) / 15]                                                                                [Stage 31:================================================>       (13 + 2) / 15]                                                                                [Stage 61:============================================>           (12 + 3) / 15]                                                                                [Stage 115:===============================================>       (13 + 2) / 15]                                                                                [Stage 131:============================================>          (12 + 2) / 15]                                                                                [Stage 148:===================================================>   (14 + 1) / 15]                                                                                [Stage 185:============================================>          (12 + 3) / 15]                                                                                [Stage 205:===================================================>   (14 + 1) / 15]                                                                                [Stage 248:===================================================>   (14 + 1) / 15]                                                                                [Stage 319:>                                                       (0 + 6) / 15][Stage 319:=============================>                          (8 + 5) / 15][Stage 319:=================================>                      (9 + 4) / 15][Stage 319:===============================================>       (13 + 2) / 15]                                                                                [Stage 324:===============================================>       (13 + 2) / 15]                                                                                [Stage 337:===================================================>   (14 + 1) / 15]                                                                                [Stage 387:===================================================>   (14 + 1) / 15]                                                                                [Stage 462:===================================================>   (14 + 1) / 15]                                                                                [Stage 519:===================================================>   (14 + 1) / 15]                                                                                [Stage 585:============================================>          (12 + 3) / 15]                                                                                [Stage 633:===================================================>   (14 + 1) / 15]                                                                                [Stage 638:====================================>                  (10 + 4) / 15]                                                                                Making all user-product combinations...
[Stage 658:>                                                      (0 + 10) / 30][Stage 658:===>                                                   (2 + 10) / 30][Stage 658:============>                                          (7 + 10) / 30][Stage 658:==================>                                   (10 + 10) / 30][Stage 658:=======================>                              (13 + 10) / 30][Stage 658:================================>                     (18 + 10) / 30][Stage 658:====================================>                 (20 + 10) / 30][Stage 658:========================================>              (22 + 8) / 30][Stage 658:=============================================>         (25 + 5) / 30][Stage 658:===================================================>   (28 + 2) / 30]                                                                                [30720, 7170, 47790, 16410, 38940]
Filtering out existing combos...
[Stage 660:============>                                          (7 + 10) / 30][Stage 660:=======================>                              (13 + 10) / 30][Stage 660:============================>                         (16 + 10) / 30][Stage 660:==================================>                   (19 + 10) / 30][Stage 660:=============================================>         (25 + 5) / 30][Stage 660:=====================================================> (29 + 1) / 30]                                                                                Generating predictions...
[Stage 663:==================>                                   (10 + 10) / 30][Stage 663:=======================>                              (13 + 10) / 30][Stage 663:====================================>                 (20 + 10) / 30][Stage 663:========================================>              (22 + 8) / 30]                                                                                [Stage 667:>                                                       (0 + 2) / 30][Stage 667:>                                                      (0 + 10) / 30][Stage 667:=>                                                     (1 + 10) / 30][Stage 667:===>                                                   (2 + 10) / 30][Stage 667:=====>                                                 (3 + 10) / 30][Stage 667:=======>                                               (4 + 10) / 30][Stage 667:=========>                                             (5 + 10) / 30][Stage 667:===========>                                           (6 + 10) / 30][Stage 667:============>                                          (7 + 10) / 30][Stage 667:==============>                                         (8 + 9) / 30][Stage 667:================>                                       (9 + 8) / 30][Stage 667:==================>                                    (10 + 7) / 30][Stage 667:====================>                                  (11 + 6) / 30][Stage 667:======================>                                (12 + 5) / 30][Stage 667:=====================>                                (12 + 10) / 30][Stage 667:=======================>                              (13 + 10) / 30][Stage 667:=========================>                            (14 + 10) / 30][Stage 667:===========================>                          (15 + 10) / 30][Stage 667:============================>                         (16 + 10) / 30][Stage 667:==============================>                       (17 + 10) / 30][Stage 667:================================>                     (18 + 10) / 30][Stage 667:==================================>                    (19 + 9) / 30][Stage 667:========================================>              (22 + 7) / 30][Stage 667:==========================================>            (23 + 6) / 30][Stage 667:============================================>          (24 + 5) / 30][Stage 667:============================================>          (24 + 6) / 30][Stage 667:=============================================>         (25 + 5) / 30][Stage 667:===============================================>       (26 + 4) / 30][Stage 667:=================================================>     (27 + 3) / 30][Stage 667:===================================================>   (28 + 2) / 30][Stage 667:=====================================================> (29 + 1) / 30]                                                                                Isolating top 100 products for each user...
Exporting...
[Stage 674:>                                                       (0 + 2) / 30][Stage 674:>                                                      (0 + 10) / 30][Stage 674:=>                                                     (1 + 10) / 30][Stage 674:===>                                                   (2 + 10) / 30][Stage 674:=====>                                                 (3 + 10) / 30][Stage 674:=======>                                               (4 + 10) / 30][Stage 674:=========>                                             (5 + 10) / 30][Stage 674:===========>                                           (6 + 10) / 30][Stage 674:==============>                                        (8 + 10) / 30][Stage 674:================>                                       (9 + 9) / 30][Stage 674:====================>                                  (11 + 7) / 30][Stage 674:======================>                                (12 + 6) / 30][Stage 674:=====================>                                (12 + 10) / 30][Stage 674:=======================>                              (13 + 10) / 30][Stage 674:=========================>                            (14 + 10) / 30][Stage 674:===========================>                          (15 + 10) / 30][Stage 674:============================>                         (16 + 10) / 30][Stage 674:==============================>                       (17 + 10) / 30][Stage 674:================================>                     (18 + 10) / 30][Stage 674:==================================>                    (19 + 9) / 30][Stage 674:====================================>                  (20 + 9) / 30][Stage 674:========================================>              (22 + 7) / 30][Stage 674:==========================================>            (23 + 6) / 30][Stage 674:============================================>          (24 + 5) / 30][Stage 674:============================================>          (24 + 6) / 30][Stage 674:=============================================>         (25 + 5) / 30][Stage 674:===============================================>       (26 + 4) / 30][Stage 674:=================================================>     (27 + 3) / 30][Stage 674:===================================================>   (28 + 2) / 30][Stage 674:=====================================================> (29 + 1) / 30][Stage 675:>                                                       (0 + 6) / 15][Stage 675:>                                                      (0 + 10) / 15][Stage 675:===>                                                   (1 + 10) / 15][Stage 675:=======>                                               (2 + 10) / 15][Stage 675:===========>                                           (3 + 10) / 15][Stage 675:==============>                                        (4 + 10) / 15][Stage 675:==================>                                     (5 + 9) / 15][Stage 675:======================>                                 (6 + 8) / 15][Stage 675:==========================>                             (7 + 7) / 15][Stage 675:=============================>                          (8 + 6) / 15][Stage 675:=================================>                      (9 + 5) / 15][Stage 675:=================================>                      (9 + 6) / 15][Stage 675:====================================>                  (10 + 5) / 15][Stage 675:========================================>              (11 + 4) / 15][Stage 675:============================================>          (12 + 3) / 15][Stage 675:===============================================>       (13 + 2) / 15][Stage 675:===================================================>   (14 + 1) / 15][Stage 676:>                                                       (0 + 6) / 15][Stage 676:>                                                      (0 + 14) / 15][Stage 676:>                                                      (0 + 15) / 15][Stage 676:>                                                      (0 + 15) / 15]17/07/30 13:51:53 WARN org.apache.spark.scheduler.cluster.YarnSchedulerBackend$YarnSchedulerEndpoint: Container marked as failed: container_1501422265636_0001_01_000010 on host: cluster-1-sw-55zj.c.kaggle-instacart-172517.internal. Exit status: -100. Diagnostics: Container released on a *lost* node
17/07/30 13:51:53 ERROR org.apache.spark.scheduler.cluster.YarnScheduler: Lost executor 8 on cluster-1-sw-55zj.c.kaggle-instacart-172517.internal: Container marked as failed: container_1501422265636_0001_01_000010 on host: cluster-1-sw-55zj.c.kaggle-instacart-172517.internal. Exit status: -100. Diagnostics: Container released on a *lost* node
17/07/30 13:51:53 WARN org.apache.spark.scheduler.TaskSetManager: Lost task 14.0 in stage 676.0 (TID 1612, cluster-1-sw-55zj.c.kaggle-instacart-172517.internal): ExecutorLostFailure (executor 8 exited caused by one of the running tasks) Reason: Container marked as failed: container_1501422265636_0001_01_000010 on host: cluster-1-sw-55zj.c.kaggle-instacart-172517.internal. Exit status: -100. Diagnostics: Container released on a *lost* node
[Stage 676:>                                                      (0 + 14) / 15][Stage 676:===>                                                   (1 + 14) / 15][Stage 676:=======>                                               (2 + 13) / 15][Stage 676:=======>                                               (2 + 13) / 15][Stage 676:===========>                                           (3 + 12) / 15][Stage 676:==============>                                        (4 + 11) / 15][Stage 676:==================>                                    (5 + 10) / 15][Stage 676:======================>                                 (6 + 9) / 15][Stage 676:==========================>                             (7 + 8) / 15][Stage 676:=============================>                          (8 + 7) / 15][Stage 676:=================================>                      (9 + 6) / 15][Stage 676:====================================>                  (10 + 5) / 15][Stage 676:========================================>              (11 + 4) / 15][Stage 676:============================================>          (12 + 3) / 15][Stage 676:===============================================>       (13 + 2) / 15][Stage 676:===================================================>   (14 + 1) / 15][Stage 677:>                                                       (0 + 2) / 15][Stage 677:>                                                      (0 + 14) / 15][Stage 677:===>                                                   (1 + 14) / 15][Stage 677:=======>                                               (2 + 13) / 15][Stage 677:===========>                                           (3 + 12) / 15][Stage 677:==============>                                        (4 + 11) / 15][Stage 677:==================>                                    (5 + 10) / 15][Stage 677:======================>                                 (6 + 9) / 15][Stage 677:==========================>                             (7 + 8) / 15][Stage 677:=============================>                          (8 + 7) / 15][Stage 677:========================================>              (11 + 4) / 15][Stage 677:============================================>          (12 + 3) / 15][Stage 677:===================================================>   (14 + 1) / 15]                                                                                Removing gs://kaggle-instacart-172517/pyspark/cf_up_rec_top.csv...
/ [1 objects]                                                                   
Operation completed over 1 objects.                                              
Copying file://cf_up_rec_top.csv [Content-Type=text/csv]...
/ [0 files][    0.0 B/ 32.4 MiB]                                                / [1 files][ 32.4 MiB/ 32.4 MiB]                                                -
Operation completed over 1 objects/32.4 MiB.                                     
17/07/30 13:55:46 INFO org.spark_project.jetty.server.ServerConnector: Stopped ServerConnector@1c18c62d{HTTP/1.1}{0.0.0.0:4040}
17/07/30 13:55:46 ERROR org.apache.spark.scheduler.LiveListenerBus: SparkListenerBus has already stopped! Dropping event SparkListenerExecutorMetricsUpdate(3,WrappedArray())
