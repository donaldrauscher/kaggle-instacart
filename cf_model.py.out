17/07/30 17:32:07 INFO org.spark_project.jetty.util.log: Logging initialized @2722ms
17/07/30 17:32:07 INFO org.spark_project.jetty.server.Server: jetty-9.2.z-SNAPSHOT
17/07/30 17:32:07 INFO org.spark_project.jetty.server.ServerConnector: Started ServerConnector@76cad120{HTTP/1.1}{0.0.0.0:4040}
17/07/30 17:32:07 INFO org.spark_project.jetty.server.Server: Started @2827ms
17/07/30 17:32:07 INFO com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystemBase: GHFS version: 1.6.1-hadoop2
17/07/30 17:32:08 INFO org.apache.hadoop.yarn.client.RMProxy: Connecting to ResourceManager at cluster-1-m/10.128.0.3:8032
17/07/30 17:32:10 INFO org.apache.hadoop.yarn.client.api.impl.YarnClientImpl: Submitted application application_1501435892274_0001
17/07/30 17:32:16 WARN org.apache.spark.SparkContext: Spark is not running in local mode, therefore the checkpoint directory must not be on the local filesystem. Directory 'checkpoint/' appears to be on the local filesystem.
17/07/30 17:32:17 INFO org.apache.hadoop.mapred.FileInputFormat: Total input paths to process : 1
Training model...
[Stage 2:>                                                         (0 + 8) / 35][Stage 2:======>                                                   (4 + 8) / 35][Stage 2:========>                                                 (5 + 8) / 35][Stage 2:=============>                                            (8 + 8) / 35][Stage 2:==============>                                           (9 + 8) / 35][Stage 2:=================>                                       (11 + 8) / 35][Stage 2:======================>                                  (14 + 8) / 35][Stage 2:==========================>                              (16 + 8) / 35][Stage 2:=============================>                           (18 + 8) / 35][Stage 2:==============================>                          (19 + 8) / 35][Stage 2:===================================>                     (22 + 8) / 35][Stage 2:=======================================>                 (24 + 8) / 35][Stage 2:===============================================>         (29 + 6) / 35][Stage 2:================================================>        (30 + 5) / 35][Stage 3:===================>                                     (12 + 6) / 35][Stage 3:=============================>                           (18 + 6) / 35][Stage 3:==========================================>              (26 + 6) / 35][Stage 4:========================================>                (12 + 5) / 17]                                                                                17/07/30 17:32:32 INFO com.github.fommil.jni.JniLoader: successfully loaded /tmp/jniloader26479441660063901netlib-native_system-linux-x86_64.so
[Stage 16:======>                                                  (2 + 6) / 17][Stage 16:=============>                                           (4 + 6) / 17][Stage 16:====================>                                    (6 + 6) / 17][Stage 16:====================================>                   (11 + 4) / 17]                                                                                [Stage 23:=======================================>                (12 + 4) / 17][Stage 23:=================================================>      (15 + 2) / 17]                                                                                [Stage 31:====================================================>   (16 + 1) / 17]                                                                                [Stage 40:==========================================>             (13 + 4) / 17]                                                                                [Stage 73:==========================================>             (13 + 4) / 17]                                                                                [Stage 86:====================================================>   (16 + 1) / 17]                                                                                [Stage 185:=============================================>         (14 + 3) / 17]                                                                                [Stage 271:===================================================>   (16 + 1) / 17]                                                                                [Stage 295:=============================================>         (14 + 3) / 17]                                                                                [Stage 319:>                                                       (0 + 6) / 17][Stage 319:======>                                                 (2 + 6) / 17][Stage 319:================================>                      (10 + 4) / 17]                                                                                [Stage 345:===================================================>   (16 + 1) / 17]                                                                                [Stage 375:===================================================>   (16 + 1) / 17]                                                                                [Stage 400:================================================>      (15 + 2) / 17]                                                                                [Stage 480:======================================>                (12 + 5) / 17]                                                                                [Stage 519:===================================================>   (16 + 1) / 17]                                                                                [Stage 562:===================================================>   (16 + 1) / 17]                                                                                [Stage 585:===================================================>   (16 + 1) / 17]                                                                                [Stage 638:=============================>                          (9 + 4) / 17][Stage 638:==========================================>            (13 + 2) / 17]                                                                                Making all user-product combinations...
[Stage 658:>                                                      (0 + 10) / 35][Stage 658:===>                                                   (2 + 10) / 35][Stage 658:======>                                                (4 + 10) / 35][Stage 658:===============>                                      (10 + 10) / 35][Stage 658:====================>                                 (13 + 10) / 35][Stage 658:========================>                             (16 + 10) / 35][Stage 658:================================>                     (21 + 10) / 35][Stage 658:=================================>                    (22 + 10) / 35][Stage 658:========================================>              (26 + 9) / 35][Stage 658:============================================>          (28 + 7) / 35][Stage 658:===============================================>       (30 + 5) / 35][Stage 658:===================================================>   (33 + 2) / 35]                                                                                [38920, 26635, 10255, 49175, 16415]
Filtering out existing combos...
[Stage 660:==============>                                        (9 + 10) / 35][Stage 660:=====================>                                (14 + 10) / 35][Stage 660:========================>                             (16 + 10) / 35][Stage 660:===================================>                  (23 + 10) / 35][Stage 660:=====================================>                (24 + 10) / 35][Stage 660:==================================================>    (32 + 3) / 35]                                                                                Generating predictions...
[Stage 663:==============>                                        (9 + 10) / 35][Stage 663:==========================>                           (17 + 10) / 35][Stage 663:===========================>                          (18 + 10) / 35][Stage 663:==========================================>            (27 + 8) / 35][Stage 663:==================================================>    (32 + 3) / 35]                                                                                [Stage 667:>                                                       (0 + 4) / 35][Stage 667:>                                                      (0 + 10) / 35][Stage 667:===>                                                   (2 + 10) / 35][Stage 667:====>                                                  (3 + 10) / 35][Stage 667:======>                                                (4 + 10) / 35][Stage 667:=======>                                               (5 + 10) / 35][Stage 667:=========>                                             (6 + 10) / 35][Stage 667:===========>                                           (7 + 10) / 35][Stage 667:============>                                           (8 + 9) / 35][Stage 667:==============>                                         (9 + 9) / 35][Stage 667:===============>                                       (10 + 9) / 35][Stage 667:===============>                                      (10 + 10) / 35][Stage 667:================>                                     (11 + 10) / 35][Stage 667:==================>                                   (12 + 10) / 35][Stage 667:====================>                                 (13 + 10) / 35][Stage 667:=====================>                                (14 + 10) / 35][Stage 667:=======================>                              (15 + 10) / 35][Stage 667:========================>                             (16 + 10) / 35][Stage 667:===========================>                          (18 + 10) / 35][Stage 667:=============================>                        (19 + 10) / 35][Stage 667:===============================>                       (20 + 9) / 35][Stage 667:=================================>                    (22 + 10) / 35][Stage 667:===================================>                  (23 + 10) / 35][Stage 667:=====================================>                (24 + 10) / 35][Stage 667:======================================>               (25 + 10) / 35][Stage 667:========================================>              (26 + 9) / 35][Stage 667:==========================================>            (27 + 8) / 35][Stage 667:============================================>          (28 + 7) / 35][Stage 667:=============================================>         (29 + 6) / 35][Stage 667:===============================================>       (30 + 5) / 35][Stage 667:================================================>      (31 + 4) / 35][Stage 667:==================================================>    (32 + 3) / 35][Stage 667:===================================================>   (33 + 2) / 35][Stage 667:=====================================================> (34 + 1) / 35]                                                                                Isolating top 100 products for each user...
Exporting...
[Stage 674:>                                                       (0 + 4) / 35][Stage 674:>                                                      (0 + 10) / 35][Stage 674:=>                                                     (1 + 10) / 35][Stage 674:===>                                                   (2 + 10) / 35][Stage 674:====>                                                  (3 + 10) / 35][Stage 674:======>                                                (4 + 10) / 35][Stage 674:=======>                                               (5 + 10) / 35][Stage 674:===========>                                           (7 + 10) / 35][Stage 674:============>                                           (8 + 9) / 35][Stage 674:==============>                                         (9 + 8) / 35][Stage 674:===============>                                       (10 + 7) / 35][Stage 674:=================>                                     (11 + 6) / 35][Stage 674:==================>                                    (12 + 5) / 35][Stage 674:==================>                                   (12 + 10) / 35][Stage 674:====================>                                 (13 + 10) / 35][Stage 674:=====================>                                (14 + 10) / 35][Stage 674:=======================>                              (15 + 10) / 35][Stage 674:========================>                             (16 + 10) / 35][Stage 674:==========================>                           (17 + 10) / 35][Stage 674:===========================>                          (18 + 10) / 35][Stage 674:=============================>                        (19 + 10) / 35][Stage 674:===============================>                       (20 + 9) / 35][Stage 674:=================================>                     (21 + 8) / 35][Stage 674:==================================>                    (22 + 7) / 35][Stage 674:====================================>                  (23 + 6) / 35][Stage 674:=====================================>                 (24 + 5) / 35][Stage 674:=====================================>                (24 + 10) / 35][Stage 674:======================================>               (25 + 10) / 35][Stage 674:========================================>              (26 + 9) / 35][Stage 674:==========================================>            (27 + 8) / 35][Stage 674:============================================>          (28 + 7) / 35][Stage 674:=============================================>         (29 + 6) / 35][Stage 674:===============================================>       (30 + 5) / 35][Stage 674:================================================>      (31 + 4) / 35][Stage 674:==================================================>    (32 + 3) / 35][Stage 674:===================================================>   (33 + 2) / 35][Stage 675:>                                                       (0 + 6) / 17][Stage 675:>                                                      (0 + 10) / 17][Stage 675:===>                                                   (1 + 10) / 17][Stage 675:======>                                                (2 + 10) / 17][Stage 675:============>                                          (4 + 10) / 17][Stage 675:================>                                      (5 + 10) / 17][Stage 675:===================>                                    (6 + 9) / 17][Stage 675:===================>                                   (6 + 10) / 17][Stage 675:======================>                                (7 + 10) / 17][Stage 675:==========================>                             (8 + 9) / 17][Stage 675:================================>                      (10 + 7) / 17][Stage 675:===================================>                   (11 + 6) / 17][Stage 675:======================================>                (12 + 5) / 17][Stage 675:==========================================>            (13 + 4) / 17][Stage 675:=============================================>         (14 + 3) / 17][Stage 675:================================================>      (15 + 2) / 17][Stage 675:===================================================>   (16 + 1) / 17][Stage 676:>                                                       (0 + 6) / 17][Stage 676:>                                                      (0 + 10) / 17][Stage 676:>                                                      (0 + 14) / 17][Stage 676:>                                                      (0 + 17) / 17][Stage 676:>                                                      (0 + 17) / 17][Stage 676:===>                                                   (1 + 16) / 17][Stage 676:======>                                                (2 + 15) / 17][Stage 676:=========>                                             (3 + 14) / 17][Stage 676:============>                                          (4 + 13) / 17][Stage 676:================>                                      (5 + 12) / 17][Stage 676:===================>                                   (6 + 11) / 17][Stage 676:======================>                                (7 + 10) / 17][Stage 676:==========================>                             (8 + 9) / 17][Stage 676:=============================>                          (9 + 8) / 17][Stage 676:===================================>                   (11 + 6) / 17][Stage 676:======================================>                (12 + 5) / 17][Stage 676:==========================================>            (13 + 4) / 17][Stage 676:=============================================>         (14 + 3) / 17][Stage 676:================================================>      (15 + 2) / 17][Stage 676:===================================================>   (16 + 1) / 17][Stage 677:>                                                      (0 + 14) / 17][Stage 677:>                                                      (0 + 16) / 17][Stage 677:===>                                                   (1 + 16) / 17][Stage 677:======>                                                (2 + 15) / 17][Stage 677:=========>                                             (3 + 14) / 17][Stage 677:============>                                          (4 + 13) / 17][Stage 677:================>                                      (5 + 12) / 17][Stage 677:===================>                                   (6 + 11) / 17][Stage 677:==========================>                             (8 + 9) / 17][Stage 677:=============================>                          (9 + 8) / 17][Stage 677:===================================>                   (11 + 6) / 17][Stage 677:======================================>                (12 + 5) / 17][Stage 677:================================================>      (15 + 2) / 17][Stage 677:===================================================>   (16 + 1) / 17]                                                                                Removing gs://kaggle-instacart-172517/pyspark/cf_up_rec_top.csv...
/ [1 objects]                                                                   
Operation completed over 1 objects.                                              
Copying file://cf_up_rec_top.csv [Content-Type=text/csv]...
/ [0 files][    0.0 B/ 32.4 MiB]                                                / [1 files][ 32.4 MiB/ 32.4 MiB]                                                
Operation completed over 1 objects/32.4 MiB.                                     
17/07/30 17:41:46 INFO org.spark_project.jetty.server.ServerConnector: Stopped ServerConnector@76cad120{HTTP/1.1}{0.0.0.0:4040}
